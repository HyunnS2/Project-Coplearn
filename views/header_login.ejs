<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <!-- CSS -->
    <link rel="stylesheet" href="/css/login.css" />
    <link rel="stylesheet" href="/css/navbar.css" />

    <!-- JQuery -->
    <script
      src="https://code.jquery.com/jquery-3.7.0.js"
      integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM="
      crossorigin="anonymous"
    ></script>

    <!-- Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- fontAwesome -->
    <script
      src="https://kit.fontawesome.com/5286d2d6db.js"
      crossorigin="anonymous"
    ></script>

    <!-- 부트스트랩 모달 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>

    <title>로그인 모달창</title>
  </head>
  <body>
    <!-- header -->
    <header>
      <nav class="navbar_hi">
        <div class="navbar_logo_hi">
          <i class=""></i>
          <a href="">Coplean</a>
        </div>
        <ul class="navbar_menu_hi">
          <li><a id="home_hi" href="#">HOME</a></li>
          <li><a id="list_hi" href="#">프로젝트 목록</a></li>
          <li>
            <a id="list_hi" href="#"
              ><i class="fa-solid fa-magnifying-glass"></i
            ></a>
          </li>
          <li>
            <a
              id="login_hi"
              data-bs-toggle="modal"
              data-bs-target="#staticBackdrop"
              href="#"
              >로그인</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <!-- Modal -->
    <div
      class="modal fade"
      id="staticBackdrop"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="staticBackdropLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="staticBackdropLabel">WELCOME !</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <!-- 로그인 폼 시작 -->
            <div class="login_content">
              <form onsubmit="event(e)" id="login_form" name="login_register">
                <img class="login_logo" src="/coplearn_logo.png" alt="로고" />

                <h2 class="title">SIGNIN</h2>

                <!-- 이메일 -->
                <div class="login_input_div login_email">
                  <div class="i"><i class="fa-solid fa-envelope"></i></div>
                  <div class="login_div">
                    <h5>EMAIL</h5>
                    <input type="email" class="login_input" id="login_email" />
                  </div>
                </div>

                <!-- 비밀번호 -->
                <div class="login_input_div login_pw">
                  <div class="i"><i class="fa-solid fa-lock"></i></div>
                  <div class="login_div">
                    <h5>PASSWORD</h5>
                    <input type="password" class="login_input" id="pw" />
                  </div>
                </div>
              </form>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="login_btn"
              data-bs-dismiss="modal"
              onclick="loginFunc()"
            >
              로그인
            </button>
            <button
              type="button"
              class="sign_btn"
              data-bs-dismiss="modal"
              onclick="location.href='./signup'"
            >
              회원가입
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- 로그인 기능 동작 JS -->

    <script>
      async function loginFunc() {
        const form = document.forms["login_form"];

        try {
          const res = await axios({
            method: "POST",
            url: "/header_login",
            data: {
              email: form.login_email.value,
              pw: form.pw.value,
            },
          });
          console.log(res);
          if (res.data.result) {
            alert("로그인 성공!");
            document.location.href = "/";
          }
        } catch (error) {
          console.log("로그인 하는 중 에러", err);
        }
      }
    </script>

    <!-- input 태그 media JS -->
    <script>
      const inputs2 = document.querySelectorAll(".login_input");

      function add_cl2() {
        let parent = this.parentNode.parentNode;
        parent.classList.add("focus");
      }

      function rem_cl2() {
        let parent = this.parentNode.parentNode;
        if (this.value == "") {
          parent.classList.remove("focus");
        }
      }

      inputs2.forEach((input) => {
        input.addEventListener("focus", add_cl2);
        input.addEventListener("blur", rem_cl2);
      });
    </script>
  </body>
</html>
